import{k as e,r as t,l as a,a as l,c as r,b as s,n as o,w as n,m as i,p as u,t as d,q as c,s as m,u as g,v as p,x as v,F as y,y as x,z as h,A as b,B as k,C as f,o as w,D as C,E as M,e as j,G as R,T as z,H as I}from"./vendor-Kq2GSEdj.js";import{g as U,r as _}from"./utils-BoXCEsRs.js";import{C as B}from"./cropper-BnGyONr1.js";const V=e("image",()=>{const e=t([]),l=t(null),r=t(null),s=t([{images:[],currentImageId:null}]),o=t(0),n=t(!1),i=a(()=>o.value>0),u=a(()=>o.value<s.value.length-1),d=()=>{if(n.value)return;const t={images:e.value.map(e=>({...e})),currentImageId:l.value?.id};o.value<s.value.length-1&&(s.value=s.value.slice(0,o.value+1)),s.value.push(t),o.value=s.value.length-1,s.value.length>50&&(s.value.shift(),o.value--)},c=()=>{const t=s.value[o.value];e.value=t.images.map(e=>({...e})),l.value=e.value.find(e=>e.id===t.currentImageId)};return{images:e,currentImage:l,cropperInstance:r,history:s,historyIndex:o,canUndo:i,canRedo:u,addImage:t=>{e.value.push(t),l.value=t,d()},setCurrentImage:e=>{l.value=e,d()},removeImage:t=>{const a=e.value.findIndex(e=>e.id===t);a>-1&&(e.value.splice(a,1),l.value?.id===t&&(l.value=e.value[0]||null),d())},setCropperInstance:e=>{r.value=e},undo:()=>{i.value&&(n.value=!0,o.value--,c(),setTimeout(()=>{n.value=!1},0))},redo:()=>{u.value&&(n.value=!0,o.value++,c(),setTimeout(()=>{n.value=!1},0))},clearHistory:()=>{s.value=[],o.value=-1}}}),L=e("settings",()=>{const e=t(1),a=t(1),l=t("free"),r=t({width:1,height:1}),s=t("png"),o=t(90),n=t("{original}_{index}"),i=t(null),u=t(null),d=t(null),c=t(!0),m=t({enabled:!1,type:"text",text:"水印",fontSize:24,color:"#ffffff",opacity:50,position:"bottom-right",rotation:0,imageUrl:null,scale:30});return{gridRows:e,gridCols:a,aspectRatio:l,customAspectRatio:r,outputFormat:s,outputQuality:o,namingTemplate:n,presetTemplate:i,outputWidth:u,outputHeight:d,maintainAspectRatio:c,watermark:m,aspectRatios:[{label:"自由",value:"free"},{label:"1:1",value:"1:1"},{label:"4:3",value:"4:3"},{label:"16:9",value:"16:9"},{label:"3:2",value:"3:2"},{label:"5:4",value:"5:4"},{label:"自定义",value:"custom"}],presetTemplates:[{name:"社交媒体头像",width:400,height:400,aspectRatio:"1:1"},{name:"Instagram 正方形",width:1080,height:1080,aspectRatio:"1:1"},{name:"Instagram 竖版",width:1080,height:1350,aspectRatio:"4:5"},{name:"Instagram 横版",width:1080,height:608,aspectRatio:"16:9"},{name:"Twitter 头像",width:400,height:400,aspectRatio:"1:1"},{name:"Twitter 封面",width:1500,height:500,aspectRatio:"3:1"},{name:"YouTube 缩略图",width:1280,height:720,aspectRatio:"16:9"},{name:"证件照 (1寸)",width:295,height:413,aspectRatio:"25:35"},{name:"证件照 (2寸)",width:413,height:579,aspectRatio:"35:49"}],setGridRows:t=>{e.value=Math.max(1,Math.min(20,t))},setGridCols:e=>{a.value=Math.max(1,Math.min(20,e))},setAspectRatio:e=>{l.value=e},setCustomAspectRatio:(e,t)=>{r.value={width:e,height:t}},setOutputFormat:e=>{s.value=e},setOutputQuality:e=>{o.value=Math.max(10,Math.min(100,e))},setNamingTemplate:e=>{n.value=e},setPresetTemplate:e=>{i.value=e,e&&(l.value=e.aspectRatio,u.value=e.width,d.value=e.height)},setOutputWidth:e=>{u.value=e>0?e:null},setOutputHeight:e=>{d.value=e>0?e:null},setMaintainAspectRatio:e=>{c.value=e},updateWatermark:e=>{m.value={...m.value,...e}},generateFileName:(e,t)=>{const a=e.replace(/\.[^/.]+$/,"");return n.value.replace("{original}",a).replace("{index}",String(t+1).padStart(3,"0"))}}});const E=U(_()),H=(e,t,a,l={})=>{e.getImageData();const r=e.getCroppedCanvas();r.getContext("2d");const s=r.width/a,o=r.height/t,n=[];for(let i=0;i<t;i++)for(let e=0;e<a;e++){const t=document.createElement("canvas");t.width=s,t.height=o;t.getContext("2d").drawImage(r,e*s,i*o,s,o,0,0,s,o),n.push(t)}return n},T=(e,t,a,l)=>{const r=20,{width:s,height:o}=l,n={"top-left":{x:r+s/2,y:r+o/2},"top-center":{x:e/2,y:r+o/2},"top-right":{x:e-r-s/2,y:r+o/2},"middle-left":{x:r+s/2,y:t/2},center:{x:e/2,y:t/2},"middle-right":{x:e-r-s/2,y:t/2},"bottom-left":{x:r+s/2,y:t-r-o/2},"bottom-center":{x:e/2,y:t-r-o/2},"bottom-right":{x:e-r-s/2,y:t-r-o/2}};return n[a]||n["bottom-right"]},S=async(e,t)=>{const a=new E;for(let l=0;l<e.length;l++){const r=e[l],s=t[l]||`image_${l+1}.png`,o=await new Promise(e=>{r.toBlob(t=>e(t),"image/png",.9)});a.file(s,o)}return await a.generateAsync({type:"blob"})},A=(e,t="cropped_images.zip")=>{const a=URL.createObjectURL(e),l=document.createElement("a");l.href=a,l.download=t,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)},P=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),W=e=>{if(!e)throw new Error("文件不存在");if(!["image/jpeg","image/png","image/webp"].includes(e.type))throw new Error("仅支持 JPG、PNG、WebP 格式的图片");if(e.size>52428800)throw new Error("图片大小不能超过 50MB");if(0===e.size)throw new Error("文件大小为 0，可能已损坏");return!0},$=e=>new Promise((t,a)=>{if(!e)return void a(new Error("文件不存在"));const l=new FileReader;l.onload=e=>{e.target.result?t(e.target.result):a(new Error("文件读取失败"))},l.onerror=e=>{a(new Error("文件读取失败，请检查文件是否损坏"))},l.onabort=()=>{a(new Error("文件读取被中断"))};try{l.readAsDataURL(e)}catch(r){a(new Error("文件读取失败"))}}),O=e=>{if("free"===e)return NaN;const[t,a]=e.split(":").map(Number);return t/a},D=e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]},N={class:"flex flex-col items-center space-y-4"},G={__name:"ImageUpload",emits:["upload"],setup(e,{emit:a}){const i=a,u=V(),d=t(null),c=t(!1),m=t(!1),g=()=>{c.value=!0},p=()=>{c.value=!1},v=async e=>{c.value=!1;const t=Array.from(e.dataTransfer.files);await b(t)},y=()=>{m.value||d.value?.click()},x=async e=>{const t=Array.from(e.target.files);await b(t),e.target.value=""},h=e=>{const t=document.createElement("div");t.className="fixed top-4 right-4 bg-red-500 text-white px-6 py-3 rounded-lg shadow-lg z-50 animate-pulse",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},3e3)},b=async e=>{if(m.value)return;const t=e.filter(e=>e.type.startsWith("image/"));if(0!==t.length){m.value=!0;for(const e of t)try{W(e);const t=await $(e);if(!t||"data:,"===t)throw new Error("文件读取失败，请重试");const a={id:P(),name:e.name,size:e.size,type:e.type,dataUrl:t,rotation:0,scaleX:1,scaleY:1,filters:{brightness:100,contrast:100,saturation:100}};u.addImage(a),i("upload",a)}catch(a){h(`${e.name}: ${a.message}`)}m.value=!1}else h("请选择有效的图片文件（JPG、PNG、WebP）")};return(e,t)=>(l(),r("div",{class:o(["upload-zone border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-8 text-center transition-all duration-300 scale-in",{"border-primary-500 bg-primary-50 dark:bg-primary-900/20 transform scale-105":c.value,"hover:border-primary-400 hover:bg-gray-50 dark:hover:bg-gray-800 hover:shadow-lg":!c.value}]),onDragover:n(g,["prevent"]),onDragleave:n(p,["prevent"]),onDrop:n(v,["prevent"]),onClick:y},[s("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/jpeg,image/png,image/webp",multiple:"",class:"hidden",onChange:x},null,544),s("div",N,[s("div",{class:o(["w-16 h-16 rounded-full bg-primary-100 dark:bg-primary-900/50 flex items-center justify-center transition-transform duration-300",{"scale-110":c.value}])},[...t[0]||(t[0]=[s("svg",{class:"w-8 h-8 text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])],2),t[1]||(t[1]=s("div",null,[s("p",{class:"text-lg font-medium text-gray-700 dark:text-gray-300"}," 拖放图片到这里或点击上传 "),s("p",{class:"text-sm text-gray-500 dark:text-gray-400 mt-1"}," 支持 JPG、PNG、WebP 格式，单张最大 50MB ")],-1)),t[2]||(t[2]=s("button",{class:"btn-primary"}," 选择图片 ",-1))])],34))}},F=(e,t)=>{const a=e.__vccOpts||e;for(const[l,r]of t)a[l]=r;return a},X={class:"cropper-container"},Y={key:0,class:"flex flex-col items-center justify-center h-full text-gray-500"},q={key:1,class:"flex flex-col items-center justify-center h-full text-red-500"},Q={class:"text-sm text-center px-4"},J=["src","alt"],K={key:3,class:"flex flex-col items-center justify-center h-full text-gray-500"},Z=F({__name:"ImageCropper",props:{image:{type:Object,required:!0},height:{type:String,default:"500px"}},emits:["crop","ready"],setup(e,{expose:a,emit:o}){const n=e,g=o,p=V(),v=L(),y=t(null),x=t(null),h=t(!1),b=t(null),k=()=>{h.value=!1,b.value=null,C()},f=e=>{h.value=!1,b.value="图片加载失败，请检查文件格式或大小"},w=()=>{n.image&&n.image.dataUrl&&(b.value=null,h.value=!0)},C=()=>{if(y.value&&y.value.complete){x.value&&(x.value.destroy(),x.value=null);try{x.value=new B(y.value,{aspectRatio:O(v.aspectRatio),viewMode:1,dragMode:"move",autoCropArea:.8,restore:!1,guides:!0,center:!0,highlight:!1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!1,background:!1,ready:()=>{p.setCropperInstance(x.value),g("ready",x.value)},crop:()=>{g("crop",x.value)}})}catch(e){b.value="图片预览初始化失败，请刷新页面重试"}}},M=()=>{x.value&&x.value.zoom(.1)},j=()=>{x.value&&x.value.zoom(-.1)},R=()=>{x.value&&(x.value.rotate(-90),n.image.rotation=(n.image.rotation-90)%360)},z=()=>{x.value&&(x.value.rotate(90),n.image.rotation=(n.image.rotation+90)%360)},I=()=>{if(x.value){const e=x.value.getData();x.value.scaleX(-e.scaleX||-1),n.image.scaleX=-1*(n.image.scaleX||1)}},U=()=>{if(x.value){const e=x.value.getData();x.value.scaleY(-e.scaleY||-1),n.image.scaleY=-1*(n.image.scaleY||1)}},_=()=>{x.value&&(x.value.reset(),n.image.rotation=0,n.image.scaleX=1,n.image.scaleY=1)};return i(()=>v.aspectRatio,()=>{x.value&&x.value.setAspectRatio(O(v.aspectRatio))}),i(()=>n.image,(e,t)=>{e&&e.id!==t?.id&&(b.value=null,h.value=!0,m(()=>{y.value&&y.value.complete&&(h.value=!1,C())}))},{deep:!0}),u(()=>{x.value&&(x.value.destroy(),x.value=null)}),a({cropper:x,zoomIn:M,zoomOut:j,rotateLeft:R,rotateRight:z,flipHorizontal:I,flipVertical:U,reset:_}),(t,a)=>(l(),r("div",X,[s("div",{class:"relative bg-gray-100 dark:bg-gray-700 rounded-lg overflow-hidden",style:c({height:e.height})},[h.value?(l(),r("div",Y,[...a[0]||(a[0]=[s("div",{class:"loading-spinner mb-4"},null,-1),s("span",{class:"text-sm"},"加载图片中...",-1)])])):b.value?(l(),r("div",q,[a[1]||(a[1]=s("svg",{class:"w-12 h-12 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),s("span",Q,d(b.value),1),s("button",{onClick:w,class:"mt-4 btn-primary text-sm px-4 py-2"}," 重试 ")])):e.image&&e.image.dataUrl?(l(),r("img",{key:2,ref_key:"imageRef",ref:y,src:e.image.dataUrl,alt:e.image.name,class:"max-w-full",onLoad:k,onError:f},null,40,J)):(l(),r("div",K,[...a[2]||(a[2]=[s("svg",{class:"w-12 h-12 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),s("span",{class:"text-sm"},"请选择图片进行预览",-1)])]))],4),s("div",{class:"flex items-center justify-center space-x-4 mt-4"},[s("button",{onClick:M,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"放大"},[...a[3]||(a[3]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})],-1)])]),s("button",{onClick:j,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"缩小"},[...a[4]||(a[4]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM13 10H7"})],-1)])]),a[10]||(a[10]=s("div",{class:"w-px h-6 bg-gray-300 dark:bg-gray-600"},null,-1)),s("button",{onClick:R,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"向左旋转"},[...a[5]||(a[5]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})],-1)])]),s("button",{onClick:z,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"向右旋转"},[...a[6]||(a[6]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})],-1)])]),a[11]||(a[11]=s("div",{class:"w-px h-6 bg-gray-300 dark:bg-gray-600"},null,-1)),s("button",{onClick:I,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"水平翻转"},[...a[7]||(a[7]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})],-1)])]),s("button",{onClick:U,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"垂直翻转"},[...a[8]||(a[8]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})],-1)])]),a[12]||(a[12]=s("div",{class:"w-px h-6 bg-gray-300 dark:bg-gray-600"},null,-1)),s("button",{onClick:_,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"重置"},[...a[9]||(a[9]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)])])])]))}},[["__scopeId","data-v-6e13706e"]]),ee={class:"settings-panel space-y-6"},te={class:"card"},ae={class:"grid grid-cols-2 gap-4"},le={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},re={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},se={class:"card"},oe={class:"space-y-4"},ne=["value"],ie={key:0,class:"grid grid-cols-2 gap-4"},ue=["value"],de={class:"card"},ce={class:"space-y-4"},me={class:"flex items-center justify-between"},ge={class:"grid grid-cols-2 gap-4"},pe={class:"flex items-center space-x-2"},ve={class:"card"},ye={class:"space-y-4"},xe={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},he={class:"card"},be={class:"space-y-4"},ke={class:"flex flex-wrap gap-2"},fe=["onClick"],we={__name:"SettingsPanel",setup(e){const n=L(),u=a({get:()=>n.gridRows,set:e=>n.setGridRows(e)}),c=a({get:()=>n.gridCols,set:e=>n.setGridCols(e)}),m=a({get:()=>n.aspectRatio,set:e=>n.setAspectRatio(e)}),k=a({get:()=>n.customAspectRatio,set:e=>n.setCustomAspectRatio(e.width,e.height)}),f=a({get:()=>n.outputFormat,set:e=>n.setOutputFormat(e)}),w=a({get:()=>n.outputQuality,set:e=>n.setOutputQuality(e)}),C=a({get:()=>n.namingTemplate,set:e=>n.setNamingTemplate(e)}),M=a(()=>n.aspectRatios),j=a(()=>n.presetTemplates),R=a({get:()=>n.presetTemplate,set:e=>n.setPresetTemplate(e)}),z=t(!1),I=a({get:()=>n.outputWidth,set:e=>n.setOutputWidth(e)}),U=a({get:()=>n.outputHeight,set:e=>n.setOutputHeight(e)}),_=a({get:()=>n.maintainAspectRatio,set:e=>n.setMaintainAspectRatio(e)});i(R,e=>{e&&(z.value=!0)});const B=["{original}_{index}","{original}_cropped_{index}","crop_{index}","img_{index}","{original}"];return(e,t)=>(l(),r("div",ee,[s("div",te,[t[13]||(t[13]=s("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white"},"裁剪网格",-1)),s("div",ae,[s("div",null,[s("label",le," 行数: "+d(u.value),1),g(s("input",{type:"range","onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),min:"1",max:"20",class:"w-full"},null,512),[[p,u.value,void 0,{number:!0}]])]),s("div",null,[s("label",re," 列数: "+d(c.value),1),g(s("input",{type:"range","onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),min:"1",max:"20",class:"w-full"},null,512),[[p,c.value,void 0,{number:!0}]])])])]),s("div",se,[t[19]||(t[19]=s("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white"},"比例设置",-1)),s("div",oe,[s("div",null,[t[14]||(t[14]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 预设比例 ",-1)),g(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>m.value=e),class:"input-field"},[(l(!0),r(y,null,x(M.value,e=>(l(),r("option",{key:e.value,value:e.value},d(e.label),9,ne))),128))],512),[[v,m.value]])]),"custom"===m.value?(l(),r("div",ie,[s("div",null,[t[15]||(t[15]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 宽度 ",-1)),g(s("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=e=>k.value.width=e),min:"1",class:"input-field"},null,512),[[p,k.value.width,void 0,{number:!0}]])]),s("div",null,[t[16]||(t[16]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 高度 ",-1)),g(s("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=e=>k.value.height=e),min:"1",class:"input-field"},null,512),[[p,k.value.height,void 0,{number:!0}]])])])):h("",!0),s("div",null,[t[18]||(t[18]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 预设模板 ",-1)),g(s("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>R.value=e),class:"input-field"},[t[17]||(t[17]=s("option",{value:null},"无",-1)),(l(!0),r(y,null,x(j.value,e=>(l(),r("option",{key:e.name,value:e},d(e.name)+" ("+d(e.width)+"x"+d(e.height)+") ",9,ue))),128))],512),[[v,R.value]])])])]),s("div",de,[t[24]||(t[24]=s("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white"},"输出尺寸",-1)),s("div",ce,[s("div",me,[t[20]||(t[20]=s("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 自定义尺寸 ",-1)),s("button",{onClick:t[6]||(t[6]=e=>z.value=!z.value),class:o(["relative inline-flex h-6 w-11 items-center rounded-full transition-colors",z.value?"bg-primary-500":"bg-gray-300 dark:bg-gray-600"])},[s("span",{class:o(["inline-block h-4 w-4 transform rounded-full bg-white transition-transform",z.value?"translate-x-6":"translate-x-1"])},null,2)],2)]),z.value?(l(),r(y,{key:0},[s("div",ge,[s("div",null,[t[21]||(t[21]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 宽度 (px) ",-1)),g(s("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=e=>I.value=e),min:"1",placeholder:"自动",class:"input-field"},null,512),[[p,I.value,void 0,{number:!0}]])]),s("div",null,[t[22]||(t[22]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 高度 (px) ",-1)),g(s("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=e=>U.value=e),min:"1",placeholder:"自动",class:"input-field"},null,512),[[p,U.value,void 0,{number:!0}]])])]),s("div",pe,[g(s("input",{type:"checkbox",id:"maintainRatio","onUpdate:modelValue":t[9]||(t[9]=e=>_.value=e),class:"w-4 h-4 rounded border-gray-300 text-primary-500 focus:ring-primary-500"},null,512),[[b,_.value]]),t[23]||(t[23]=s("label",{for:"maintainRatio",class:"text-sm text-gray-700 dark:text-gray-300"}," 保持宽高比 ",-1))])],64)):h("",!0)])]),s("div",ve,[t[28]||(t[28]=s("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white"},"输出设置",-1)),s("div",ye,[s("div",null,[t[26]||(t[26]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 输出格式 ",-1)),g(s("select",{"onUpdate:modelValue":t[10]||(t[10]=e=>f.value=e),class:"input-field"},[...t[25]||(t[25]=[s("option",{value:"png"},"PNG (无损)",-1),s("option",{value:"jpeg"},"JPG (压缩)",-1),s("option",{value:"webp"},"WebP (高效)",-1)])],512),[[v,f.value]])]),s("div",null,[s("label",xe," 质量: "+d(w.value)+"% ",1),g(s("input",{type:"range","onUpdate:modelValue":t[11]||(t[11]=e=>w.value=e),min:"10",max:"100",class:"w-full"},null,512),[[p,w.value,void 0,{number:!0}]]),t[27]||(t[27]=s("div",{class:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1"},[s("span",null,"最小"),s("span",null,"最佳")],-1))])])]),s("div",he,[t[31]||(t[31]=s("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white"},"命名规则",-1)),s("div",be,[s("div",null,[t[29]||(t[29]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 命名模板 ",-1)),g(s("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>C.value=e),type:"text",class:"input-field",placeholder:"{original}_{index}"},null,512),[[p,C.value]]),t[30]||(t[30]=s("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," 可用变量: {original} - 原文件名, {index} - 序号 ",-1))]),s("div",ke,[(l(),r(y,null,x(B,e=>s("button",{key:e,onClick:t=>C.value=e,class:"px-3 py-1 text-sm bg-gray-200 dark:bg-gray-700 rounded hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors"},d(e),9,fe)),64))])])])]))}},Ce={class:"filters-panel space-y-4"},Me={class:"space-y-4"},je={class:"flex justify-between mb-2"},Re={class:"text-sm text-gray-500 dark:text-gray-400"},ze={class:"flex justify-between mb-2"},Ie={class:"text-sm text-gray-500 dark:text-gray-400"},Ue={class:"flex justify-between mb-2"},_e={class:"text-sm text-gray-500 dark:text-gray-400"},Be={class:"flex justify-between mb-2"},Ve={class:"text-sm text-gray-500 dark:text-gray-400"},Le={class:"flex justify-between mb-2"},Ee={class:"text-sm text-gray-500 dark:text-gray-400"},He={class:"flex flex-wrap gap-2"},Te={__name:"FiltersPanel",props:{cropper:{type:Object,default:null}},setup(e){const o=e,n=V(),u=t({brightness:100,contrast:100,saturation:100,grayscale:0,blur:0}),c=a(()=>`brightness(${u.value.brightness}%) contrast(${u.value.contrast}%) saturate(${u.value.saturation}%) grayscale(${u.value.grayscale}%) blur(${u.value.blur}px)`),m=()=>{if(!o.cropper)return;const e=o.cropper.container;if(e){const t=e.querySelector(".cropper-canvas img");t&&(t.style.filter=c.value)}const t=n.currentImage;t&&(t.filters={...u.value})},v=()=>{u.value={brightness:100,contrast:100,saturation:100,grayscale:0,blur:0},m()},y=e=>{switch(e){case"vintage":u.value={brightness:110,contrast:90,saturation:80,grayscale:20,blur:0};break;case"bw":u.value={brightness:100,contrast:120,saturation:0,grayscale:100,blur:0};break;case"warm":u.value={brightness:105,contrast:95,saturation:120,grayscale:0,blur:0};break;case"cool":u.value={brightness:100,contrast:110,saturation:90,grayscale:0,blur:0}}m()};return i(()=>n.currentImage,e=>{e&&e.filters?u.value={...e.filters}:v()},{immediate:!0}),i(()=>o.cropper,e=>{e&&m()}),(e,t)=>(l(),r("div",Ce,[t[14]||(t[14]=s("h3",{class:"text-lg font-semibold text-gray-800 dark:text-white"},"图片滤镜",-1)),s("div",Me,[s("div",null,[s("div",je,[t[9]||(t[9]=s("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 亮度 ",-1)),s("span",Re,d(u.value.brightness)+"%",1)]),g(s("input",{type:"range","onUpdate:modelValue":t[0]||(t[0]=e=>u.value.brightness=e),min:"0",max:"200",class:"w-full",onInput:m},null,544),[[p,u.value.brightness,void 0,{number:!0}]])]),s("div",null,[s("div",ze,[t[10]||(t[10]=s("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 对比度 ",-1)),s("span",Ie,d(u.value.contrast)+"%",1)]),g(s("input",{type:"range","onUpdate:modelValue":t[1]||(t[1]=e=>u.value.contrast=e),min:"0",max:"200",class:"w-full",onInput:m},null,544),[[p,u.value.contrast,void 0,{number:!0}]])]),s("div",null,[s("div",Ue,[t[11]||(t[11]=s("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 饱和度 ",-1)),s("span",_e,d(u.value.saturation)+"%",1)]),g(s("input",{type:"range","onUpdate:modelValue":t[2]||(t[2]=e=>u.value.saturation=e),min:"0",max:"200",class:"w-full",onInput:m},null,544),[[p,u.value.saturation,void 0,{number:!0}]])]),s("div",null,[s("div",Be,[t[12]||(t[12]=s("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 灰度 ",-1)),s("span",Ve,d(u.value.grayscale)+"%",1)]),g(s("input",{type:"range","onUpdate:modelValue":t[3]||(t[3]=e=>u.value.grayscale=e),min:"0",max:"100",class:"w-full",onInput:m},null,544),[[p,u.value.grayscale,void 0,{number:!0}]])]),s("div",null,[s("div",Le,[t[13]||(t[13]=s("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 模糊 ",-1)),s("span",Ee,d(u.value.blur)+"px",1)]),g(s("input",{type:"range","onUpdate:modelValue":t[4]||(t[4]=e=>u.value.blur=e),min:"0",max:"10",step:"0.5",class:"w-full",onInput:m},null,544),[[p,u.value.blur,void 0,{number:!0}]])])]),s("div",He,[s("button",{onClick:v,class:"flex-1 btn-secondary text-sm"}," 重置 "),s("button",{onClick:t[5]||(t[5]=e=>y("vintage")),class:"flex-1 btn-primary text-sm"}," 复古 "),s("button",{onClick:t[6]||(t[6]=e=>y("bw")),class:"flex-1 btn-primary text-sm"}," 黑白 "),s("button",{onClick:t[7]||(t[7]=e=>y("warm")),class:"flex-1 btn-primary text-sm"}," 暖色 "),s("button",{onClick:t[8]||(t[8]=e=>y("cool")),class:"flex-1 btn-primary text-sm"}," 冷色 ")])]))}},Se={class:"image-list"},Ae={key:0,class:"text-center text-gray-500 dark:text-gray-400 py-8"},Pe={key:1,class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4"},We=["onClick"],$e=["src","alt"],Oe={class:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity duration-200 rounded-lg flex items-center justify-center"},De=["onClick"],Ne={class:"mt-2"},Ge=["title"],Fe={class:"text-xs text-gray-500 dark:text-gray-400"},Xe={__name:"ImageList",emits:["remove"],setup(e,{emit:t}){const i=t,u=V(),c=a(()=>u.images),m=a(()=>u.currentImage);return(e,t)=>(l(),r("div",Se,[0===c.value.length?(l(),r("div",Ae,[...t[0]||(t[0]=[s("svg",{class:"w-12 h-12 mx-auto mb-3 text-gray-300 dark:text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),s("p",null,"暂无图片，请上传",-1)])])):(l(),r("div",Pe,[(l(!0),r(y,null,x(c.value,e=>(l(),r("div",{key:e.id,class:"relative group cursor-pointer",onClick:t=>(e=>{u.setCurrentImage(e)})(e)},[s("div",{class:o(["aspect-square rounded-lg overflow-hidden border-2 transition-all duration-200",{"border-primary-500 ring-2 ring-primary-500/30 shadow-lg":m.value?.id===e.id,"border-gray-200 dark:border-gray-700 hover:border-primary-300 dark:hover:border-primary-600":m.value?.id!==e.id}])},[s("img",{src:e.dataUrl,alt:e.name,class:"w-full h-full object-cover transition-transform duration-200 group-hover:scale-105"},null,8,$e)],2),s("div",Oe,[s("button",{onClick:n(t=>{return a=e.id,void i("remove",a);var a},["stop"]),class:"p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors transform hover:scale-110",title:"删除"},[...t[1]||(t[1]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,De)]),s("div",Ne,[s("p",{class:"text-sm text-gray-700 dark:text-gray-300 truncate",title:e.name},d(e.name),9,Ge),s("p",Fe,d(k(D)(e.size)),1)])],8,We))),128))]))]))}},Ye={key:0,class:"image-info card"},qe={class:"space-y-3"},Qe={class:"flex justify-between items-center py-2 border-b border-gray-100 dark:border-gray-700"},Je=["title"],Ke={class:"flex justify-between items-center py-2 border-b border-gray-100 dark:border-gray-700"},Ze={class:"text-sm font-medium text-gray-800 dark:text-white"},et={class:"flex justify-between items-center py-2 border-b border-gray-100 dark:border-gray-700"},tt={class:"text-sm font-medium text-gray-800 dark:text-white"},at={key:0,class:"flex justify-between items-center py-2 border-b border-gray-100 dark:border-gray-700"},lt={class:"text-sm font-medium text-gray-800 dark:text-white"},rt={key:1,class:"flex justify-between items-center py-2 border-b border-gray-100 dark:border-gray-700"},st={class:"text-sm font-medium text-gray-800 dark:text-white"},ot={key:2,class:"flex justify-between items-center py-2 border-b border-gray-100 dark:border-gray-700"},nt={class:"text-sm font-medium text-gray-800 dark:text-white"},it={key:3,class:"flex justify-between items-center py-2"},ut={class:"text-sm font-medium text-gray-800 dark:text-white"},dt={key:0,class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-600"},ct={class:"flex flex-wrap gap-2"},mt={__name:"ImageInfo",props:{image:{type:Object,default:null},cropper:{type:Object,default:null}},setup(e){const o=e;V();const n=t(null),u=t(null),c=e=>{const t=[];return-1===e.scaleX&&t.push("水平"),-1===e.scaleY&&t.push("垂直"),t.join(" + ")||"无"},m={brightness:"亮度",contrast:"对比度",saturation:"饱和度",grayscale:"灰度",blur:"模糊"},g=a(()=>{if(!o.image?.filters)return!1;const e=o.image.filters;return 100!==e.brightness||100!==e.contrast||100!==e.saturation||e.grayscale>0||e.blur>0}),p=a(()=>{if(!o.image?.filters)return{};const e=o.image.filters,t={};return 100!==e.brightness&&(t.brightness=e.brightness),100!==e.contrast&&(t.contrast=e.contrast),100!==e.saturation&&(t.saturation=e.saturation),e.grayscale>0&&(t.grayscale=e.grayscale),e.blur>0&&(t.blur=e.blur),t}),v=()=>{if(o.cropper)try{u.value=o.cropper.getCropBoxData()}catch(e){u.value=null}};return i(()=>o.image,()=>{if(!o.image?.dataUrl)return;const e=new Image;e.onload=()=>{n.value={width:e.width,height:e.height}},e.src=o.image.dataUrl},{immediate:!0}),i(()=>o.cropper,e=>{e&&(v(),e.on("crop",v))},{immediate:!0}),(t,a)=>{return e.image?(l(),r("div",Ye,[a[8]||(a[8]=s("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center"},[s("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),f(" 图片信息 ")],-1)),s("div",qe,[s("div",Qe,[a[0]||(a[0]=s("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"文件名",-1)),s("span",{class:"text-sm font-medium text-gray-800 dark:text-white truncate max-w-[150px]",title:e.image.name},d(e.image.name),9,Je)]),s("div",Ke,[a[1]||(a[1]=s("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"文件大小",-1)),s("span",Ze,d(k(D)(e.image.size)),1)]),s("div",et,[a[2]||(a[2]=s("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"文件类型",-1)),s("span",tt,d((o=e.image.type,{"image/jpeg":"JPEG","image/png":"PNG","image/webp":"WebP"}[o]||o)),1)]),n.value?(l(),r("div",at,[a[3]||(a[3]=s("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"原始尺寸",-1)),s("span",lt,d(n.value.width)+" × "+d(n.value.height)+" px ",1)])):h("",!0),u.value?(l(),r("div",rt,[a[4]||(a[4]=s("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"裁剪区域",-1)),s("span",st,d(Math.round(u.value.width))+" × "+d(Math.round(u.value.height))+" px ",1)])):h("",!0),e.image.rotation?(l(),r("div",ot,[a[5]||(a[5]=s("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"旋转角度",-1)),s("span",nt,d(e.image.rotation)+"° ",1)])):h("",!0),1!==e.image.scaleX||1!==e.image.scaleY?(l(),r("div",it,[a[6]||(a[6]=s("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"翻转",-1)),s("span",ut,d(c(e.image)),1)])):h("",!0)]),g.value?(l(),r("div",dt,[a[7]||(a[7]=s("h4",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2"},"已应用滤镜",-1)),s("div",ct,[(l(!0),r(y,null,x(p.value,(e,t)=>(l(),r("span",{key:t,class:"px-2 py-1 text-xs bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300 rounded"},d((e=>m[e]||e)(t))+": "+d(((e,t)=>"blur"===e?`${t}px`:`${t}%`)(t,e)),1))),128))])])):h("",!0)])):h("",!0);var o}}},gt={class:"watermark-panel card"},pt={class:"space-y-4"},vt={class:"flex items-center justify-between"},yt={class:"flex space-x-2"},xt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ht={class:"flex items-center space-x-2"},bt=["src"],kt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ft={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},wt={class:"grid grid-cols-3 gap-2"},Ct=["onClick"],Mt={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},jt={__name:"WatermarkPanel",setup(e){const n=L(),i=t(null),u=[{label:"左上",value:"top-left"},{label:"上中",value:"top-center"},{label:"右上",value:"top-right"},{label:"左中",value:"middle-left"},{label:"居中",value:"center"},{label:"右中",value:"middle-right"},{label:"左下",value:"bottom-left"},{label:"下中",value:"bottom-center"},{label:"右下",value:"bottom-right"}],c=a({get:()=>n.watermark.enabled,set:e=>n.updateWatermark({enabled:e})}),m=a({get:()=>n.watermark.type,set:e=>n.updateWatermark({type:e})}),v=a({get:()=>n.watermark.text,set:e=>n.updateWatermark({text:e})}),b=a({get:()=>n.watermark.fontSize,set:e=>n.updateWatermark({fontSize:e})}),k=a({get:()=>n.watermark.color,set:e=>n.updateWatermark({color:e})}),w=a({get:()=>n.watermark.opacity,set:e=>n.updateWatermark({opacity:e})}),C=a({get:()=>n.watermark.position,set:e=>n.updateWatermark({position:e})}),M=a({get:()=>n.watermark.rotation,set:e=>n.updateWatermark({rotation:e})}),j=a({get:()=>n.watermark.scale,set:e=>n.updateWatermark({scale:e})}),R=a(()=>n.watermark.imageUrl),z=()=>{i.value?.click()},I=e=>{const t=e.target.files?.[0];if(t){const e=new FileReader;e.onload=e=>{n.updateWatermark({imageUrl:e.target.result})},e.readAsDataURL(t)}e.target.value=""};return(e,t)=>(l(),r("div",gt,[t[19]||(t[19]=s("h3",{class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center"},[s("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})]),f(" 水印设置 ")],-1)),s("div",pt,[s("div",vt,[t[10]||(t[10]=s("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," 启用水印 ",-1)),s("button",{onClick:t[0]||(t[0]=e=>c.value=!c.value),class:o(["relative inline-flex h-6 w-11 items-center rounded-full transition-colors",c.value?"bg-primary-500":"bg-gray-300 dark:bg-gray-600"])},[s("span",{class:o(["inline-block h-4 w-4 transform rounded-full bg-white transition-transform",c.value?"translate-x-6":"translate-x-1"])},null,2)],2)]),c.value?(l(),r(y,{key:0},[s("div",null,[t[11]||(t[11]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 水印类型 ",-1)),s("div",yt,[s("button",{onClick:t[1]||(t[1]=e=>m.value="text"),class:o(["flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all","text"===m.value?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"])}," 文字 ",2),s("button",{onClick:t[2]||(t[2]=e=>m.value="image"),class:o(["flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all","image"===m.value?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"])}," 图片 ",2)])]),"text"===m.value?(l(),r(y,{key:0},[s("div",null,[t[12]||(t[12]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 水印文字 ",-1)),g(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>v.value=e),type:"text",class:"input-field",placeholder:"请输入水印文字"},null,512),[[p,v.value]])]),s("div",null,[s("label",xt," 字体大小: "+d(b.value)+"px ",1),g(s("input",{type:"range","onUpdate:modelValue":t[4]||(t[4]=e=>b.value=e),min:"12",max:"72",class:"w-full"},null,512),[[p,b.value,void 0,{number:!0}]])]),s("div",null,[t[13]||(t[13]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 文字颜色 ",-1)),s("div",ht,[g(s("input",{type:"color","onUpdate:modelValue":t[5]||(t[5]=e=>k.value=e),class:"w-10 h-10 rounded cursor-pointer border-0"},null,512),[[p,k.value]]),g(s("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=e=>k.value=e),class:"input-field flex-1",placeholder:"#ffffff"},null,512),[[p,k.value]])])])],64)):(l(),r(y,{key:1},[s("div",null,[t[17]||(t[17]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 水印图片 ",-1)),s("div",{class:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-4 text-center cursor-pointer hover:border-primary-500 transition-colors",onClick:z},[s("input",{ref_key:"imageInput",ref:i,type:"file",accept:"image/*",class:"hidden",onChange:I},null,544),R.value?(l(),r(y,{key:0},[s("img",{src:R.value,class:"max-h-20 mx-auto mb-2"},null,8,bt),t[14]||(t[14]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"点击更换图片",-1))],64)):(l(),r(y,{key:1},[t[15]||(t[15]=s("svg",{class:"w-8 h-8 mx-auto mb-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),t[16]||(t[16]=s("p",{class:"text-sm text-gray-500 dark:text-gray-400"},"点击上传水印图片",-1))],64))])]),s("div",null,[s("label",kt," 缩放比例: "+d(j.value)+"% ",1),g(s("input",{type:"range","onUpdate:modelValue":t[7]||(t[7]=e=>j.value=e),min:"10",max:"100",class:"w-full"},null,512),[[p,j.value,void 0,{number:!0}]])])],64)),s("div",null,[s("label",ft," 透明度: "+d(w.value)+"% ",1),g(s("input",{type:"range","onUpdate:modelValue":t[8]||(t[8]=e=>w.value=e),min:"10",max:"100",class:"w-full"},null,512),[[p,w.value,void 0,{number:!0}]])]),s("div",null,[t[18]||(t[18]=s("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," 位置 ",-1)),s("div",wt,[(l(),r(y,null,x(u,e=>s("button",{key:e.value,onClick:t=>C.value=e.value,class:o(["py-2 px-3 rounded-lg text-xs font-medium transition-all",C.value===e.value?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"])},d(e.label),11,Ct)),64))])]),s("div",null,[s("label",Mt," 旋转角度: "+d(M.value)+"° ",1),g(s("input",{type:"range","onUpdate:modelValue":t[9]||(t[9]=e=>M.value=e),min:"-180",max:"180",class:"w-full"},null,512),[[p,M.value,void 0,{number:!0}]])])],64)):h("",!0)])]))}},Rt={class:"flex-shrink-0"},zt={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},It={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ut={key:2,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},_t={key:3,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Bt={class:"text-sm font-medium"},Vt=F({__name:"Toast",props:{message:{type:String,required:!0},type:{type:String,default:"success",validator:e=>["success","error","warning","info"].includes(e)},duration:{type:Number,default:3e3},position:{type:String,default:"top-right",validator:e=>["top-right","top-left","bottom-right","bottom-left","top-center","bottom-center"].includes(e)}},emits:["close"],setup(e,{emit:n}){const i=e,u=n,m=t(!0);let g=null;const p=a(()=>{const e={success:"bg-green-500 text-white",error:"bg-red-500 text-white",warning:"bg-yellow-500 text-white",info:"bg-blue-500 text-white"};return e[i.type]||e.info}),v=a(()=>{const e={"top-right":{top:"1rem",right:"1rem"},"top-left":{top:"1rem",left:"1rem"},"bottom-right":{bottom:"1rem",right:"1rem"},"bottom-left":{bottom:"1rem",left:"1rem"},"top-center":{top:"1rem",left:"50%",transform:"translateX(-50%)"},"bottom-center":{bottom:"1rem",left:"50%",transform:"translateX(-50%)"}};return e[i.position]||e["top-right"]}),y=()=>{m.value=!1,g&&clearTimeout(g),u("close")};return w(()=>{i.duration>0&&(g=setTimeout(y,i.duration))}),C(()=>{g&&clearTimeout(g)}),(t,a)=>(l(),M(I,{to:"body"},[j(z,{name:"toast"},{default:R(()=>[m.value?(l(),r("div",{key:0,class:o(["fixed z-50 flex items-center space-x-3 px-4 py-3 rounded-lg shadow-lg max-w-sm",p.value]),style:c(v.value)},[s("div",Rt,["success"===e.type?(l(),r("svg",zt,[...a[0]||(a[0]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])])):"error"===e.type?(l(),r("svg",It,[...a[1]||(a[1]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)])])):"warning"===e.type?(l(),r("svg",Ut,[...a[2]||(a[2]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])])):(l(),r("svg",_t,[...a[3]||(a[3]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])]))]),s("p",Bt,d(e.message),1),s("button",{onClick:y,class:"flex-shrink-0 p-1 rounded hover:bg-white/20 transition-colors"},[...a[4]||(a[4]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])],6)):h("",!0)]),_:1})]))}},[["__scopeId","data-v-3304d16e"]]),Lt={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Et={class:"flex min-h-full items-center justify-center p-4"},Ht={class:"relative bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6 transform transition-all"},Tt={class:"flex items-start space-x-4"},St={key:0,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},At={key:1,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pt={key:2,class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Wt={class:"flex-1"},$t={class:"text-lg font-semibold text-gray-900 dark:text-white"},Ot={class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},Dt={class:"mt-6 flex justify-end space-x-3"},Nt=F({__name:"ConfirmDialog",props:{visible:{type:Boolean,default:!1},title:{type:String,default:"确认操作"},message:{type:String,default:"您确定要执行此操作吗？"},type:{type:String,default:"info",validator:e=>["info","warning","danger"].includes(e)},confirmText:{type:String,default:"确认"},cancelText:{type:String,default:"取消"}},emits:["confirm","cancel","update:visible"],setup(e,{emit:t}){const n=e,i=t,u=a(()=>{const e={danger:"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400",warning:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-600 dark:text-yellow-400",info:"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400"};return e[n.type]||e.info}),c=a(()=>{const e={danger:"bg-red-500 hover:bg-red-600",warning:"bg-yellow-500 hover:bg-yellow-600",info:"bg-primary-500 hover:bg-primary-600"};return e[n.type]||e.info}),m=()=>{i("confirm"),i("update:visible",!1)},g=()=>{i("cancel"),i("update:visible",!1)},p=e=>{n.visible&&("Escape"===e.key?g():"Enter"===e.key&&m())};return w(()=>{document.addEventListener("keydown",p)}),C(()=>{document.removeEventListener("keydown",p)}),(t,a)=>(l(),M(I,{to:"body"},[j(z,{name:"modal"},{default:R(()=>[e.visible?(l(),r("div",Lt,[s("div",Et,[s("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity",onClick:g}),s("div",Ht,[s("div",Tt,[s("div",{class:o(["flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center",u.value])},["danger"===e.type?(l(),r("svg",St,[...a[0]||(a[0]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"},null,-1)])])):"warning"===e.type?(l(),r("svg",At,[...a[1]||(a[1]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])])):(l(),r("svg",Pt,[...a[2]||(a[2]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)])]))],2),s("div",Wt,[s("h3",$t,d(e.title),1),s("p",Ot,d(e.message),1)])]),s("div",Dt,[s("button",{onClick:g,class:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},d(e.cancelText),1),s("button",{onClick:m,class:o(["px-4 py-2 text-sm font-medium text-white rounded-lg transition-colors",c.value])},d(e.confirmText),3)])])])])):h("",!0)]),_:1})]))}},[["__scopeId","data-v-1a9cd6a0"]]),Gt={class:"shortcuts-help"},Ft={class:"flex items-center justify-between mb-6"},Xt={class:"space-y-4"},Yt={class:"text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"},qt={class:"space-y-2"},Qt={class:"text-sm text-gray-700 dark:text-gray-300"},Jt={class:"flex items-center space-x-1"},Kt=F({__name:"ShortcutsHelp",setup(e){const a=t(!1),o=[{title:"历史操作",shortcuts:[{description:"撤销",keys:["Ctrl","Z"]},{description:"重做",keys:["Ctrl","Y"]}]},{title:"图片操作",shortcuts:[{description:"放大",keys:["Ctrl","+"]},{description:"缩小",keys:["Ctrl","-"]},{description:"向左旋转",keys:["Ctrl","←"]},{description:"向右旋转",keys:["Ctrl","→"]},{description:"重置",keys:["Ctrl","R"]}]},{title:"文件操作",shortcuts:[{description:"上传图片",keys:["Ctrl","U"]},{description:"下载裁剪",keys:["Ctrl","S"]}]},{title:"界面操作",shortcuts:[{description:"切换深色模式",keys:["Ctrl","D"]},{description:"显示快捷键",keys:["?"]}]}],i=e=>{if("?"===e.key&&!e.ctrlKey&&!e.metaKey){const e=document.activeElement;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName)return;a.value=!a.value}"Escape"===e.key&&a.value&&(a.value=!1)};return w(()=>{document.addEventListener("keydown",i)}),C(()=>{document.removeEventListener("keydown",i)}),(e,t)=>(l(),r("div",Gt,[s("button",{onClick:t[0]||(t[0]=e=>a.value=!a.value),class:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"快捷键帮助"},[...t[4]||(t[4]=[s("svg",{class:"w-5 h-5 text-gray-600 dark:text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])]),(l(),M(I,{to:"body"},[j(z,{name:"fade"},{default:R(()=>[a.value?(l(),r("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:t[3]||(t[3]=e=>a.value=!1)},[s("div",{class:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-lg w-full mx-4 p-6 transform transition-all",onClick:t[2]||(t[2]=n(()=>{},["stop"]))},[s("div",Ft,[t[6]||(t[6]=s("h3",{class:"text-xl font-bold text-gray-900 dark:text-white"},"快捷键",-1)),s("button",{onClick:t[1]||(t[1]=e=>a.value=!1),class:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"},[...t[5]||(t[5]=[s("svg",{class:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),s("div",Xt,[(l(),r(y,null,x(o,e=>s("div",{key:e.title,class:"space-y-2"},[s("h4",Yt,d(e.title),1),s("div",qt,[(l(!0),r(y,null,x(e.shortcuts,e=>(l(),r("div",{key:e.key,class:"flex items-center justify-between py-2 px-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[s("span",Qt,d(e.description),1),s("div",Jt,[(l(!0),r(y,null,x(e.keys,(e,t)=>(l(),r("kbd",{key:t,class:"px-2 py-1 text-xs font-semibold text-gray-800 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded shadow-sm"},d(e),1))),128))])]))),128))])])),64))]),t[7]||(t[7]=s("div",{class:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700"},[s("p",{class:"text-xs text-gray-500 dark:text-gray-400 text-center"},[f(" 按 "),s("kbd",{class:"px-1.5 py-0.5 text-xs bg-gray-100 dark:bg-gray-700 rounded"},"Esc"),f(" 关闭此面板 ")])],-1))])])):h("",!0)]),_:1})]))]))}},[["__scopeId","data-v-df24b02e"]]),Zt={class:"home min-h-screen"},ea={class:"mb-8"},ta={class:"flex items-center justify-between"},aa={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},la={class:"lg:col-span-2 space-y-6"},ra={key:0,class:"card"},sa={class:"flex items-center justify-between mb-4"},oa={class:"text-lg font-semibold text-gray-800 dark:text-white flex items-center"},na={class:"flex space-x-2"},ia=["disabled"],ua=["disabled"],da={class:"mt-6 flex flex-wrap gap-3"},ca=["disabled"],ma={class:"space-y-6"},ga={key:1,class:"card"},pa={class:"text-lg font-semibold mb-4 text-gray-800 dark:text-white flex items-center"},va={class:"fixed bottom-4 left-4 space-y-2 z-40"},ya={__name:"Home",setup(e){const o=V(),n=L(),i=t(null),u=t(!1),c=t(0),m=t([]),g=t(0),p=t(!1),v=t(""),b=t(""),k=t("info"),R=t(null),z=a(()=>o.currentImage),I=a(()=>o.images),U=a(()=>o.canUndo),_=a(()=>o.canRedo),B=a(()=>n.gridRows),P=a(()=>n.gridCols),W=e=>{$(`${e.name} 上传成功`,"success")},$=(e,t="success",a=3e3)=>{const l=g.value++;m.value.push({id:l,message:e,type:t,duration:a})},O=(e,t,a,l)=>{v.value=e,b.value=t,k.value=a,R.value=l,p.value=!0},D=()=>{R.value&&R.value(),R.value=null},N=()=>{R.value=null},F=()=>{o.undo()},X=()=>{o.redo()},Y=async e=>{let t=e;return(n.outputWidth||n.outputHeight)&&(t=((e,t,a,l=!0)=>{if(!t&&!a)return e;const r=e.width,s=e.height;let o=t||r,n=a||s;if(l&&t&&a){const e=r/s;e>t/a?(n=t/e,o=t):(o=a*e,n=a)}else if(l){const e=r/s;t?n=t/e:a&&(o=a*e)}const i=document.createElement("canvas");i.width=o,i.height=n;const u=i.getContext("2d");return u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high",u.drawImage(e,0,0,r,s,0,0,o,n),i})(t,n.outputWidth,n.outputHeight,n.maintainAspectRatio)),n.watermark.enabled&&(t=await((e,t)=>{if(!t.enabled)return e;const a=e.getContext("2d"),{width:l,height:r}=e;if(a.save(),a.globalAlpha=t.opacity/100,"text"===t.type&&t.text){const e=T(l,r,t.position,{width:a.measureText(t.text).width+t.fontSize,height:1.5*t.fontSize});a.translate(e.x,e.y),a.rotate(t.rotation*Math.PI/180),a.font=`${t.fontSize}px Arial, sans-serif`,a.fillStyle=t.color,a.textAlign="center",a.textBaseline="middle",a.shadowColor="rgba(0, 0, 0, 0.5)",a.shadowBlur=4,a.shadowOffsetX=2,a.shadowOffsetY=2,a.fillText(t.text,0,0)}else if("image"===t.type&&t.imageUrl)return new Promise(s=>{const o=new Image;o.crossOrigin="anonymous",o.onload=()=>{const n=t.scale/100,i=o.width*n,u=o.height*n,d=T(l,r,t.position,{width:i,height:u});a.translate(d.x,d.y),a.rotate(t.rotation*Math.PI/180),a.drawImage(o,-i/2,-u/2,i,u),a.restore(),s(e)},o.onerror=()=>{a.restore(),s(e)},o.src=t.imageUrl});return a.restore(),e})(t,n.watermark)),t},q=async()=>{if(i.value?.cropper)try{let e=((e,t={})=>{const{format:a="image/png",quality:l=.9,width:r,height:s}=t;return e.getCroppedCanvas({imageSmoothingEnabled:!0,imageSmoothingQuality:"high",maxWidth:r,maxHeight:s})})(i.value.cropper,{format:`image/${n.outputFormat}`,quality:n.outputQuality/100});e=await Y(e);const t=await((e,t="image/png",a=.9)=>new Promise(l=>{e.toBlob(e=>{l(e)},t,a)}))(e,`image/${n.outputFormat}`,n.outputQuality/100);((e,t)=>{const a=URL.createObjectURL(e),l=document.createElement("a");l.href=a,l.download=t,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(a)})(t,`${n.generateFileName(z.value.name,0)}.${n.outputFormat}`),$("图片下载成功","success")}catch(e){$("裁剪失败，请重试","error")}},Q=async()=>{if(i.value?.cropper)try{u.value=!0,c.value=0;const e=H(i.value.cropper,B.value,P.value);c.value=30;const t=[];for(let r=0;r<e.length;r++){const a=await Y(e[r]);t.push(a),c.value=30+Math.round(r/e.length*40)}const a=t.map((e,t)=>n.generateFileName(z.value.name,t)),l=await S(t,a);A(l,`${z.value.name.replace(/\.[^/.]+$/,"")}_grid.zip`),c.value=100,$(`成功裁剪 ${e.length} 张图片`,"success")}catch(e){$("网格裁剪失败，请重试","error")}finally{u.value=!1,c.value=0}},J=async()=>{if(0!==I.value.length)try{u.value=!0,c.value=0;const e=[],t=[],a=I.value.length;for(let l=0;l<I.value.length;l++){const r=I.value[l];if(o.setCurrentImage(r),await new Promise(e=>setTimeout(e,100)),i.value?.cropper){const a=H(i.value.cropper,B.value,P.value);for(let l=0;l<a.length;l++){const s=await Y(a[l]);e.push(s),t.push(n.generateFileName(r.name,l))}}c.value=Math.round((l+1)/a*100)}if(e.length>0){const a=await S(e,t);A(a,"all_cropped_images.zip"),$(`成功处理 ${e.length} 张图片`,"success")}}catch(e){$("批量处理失败，请重试","error")}finally{u.value=!1,c.value=0}},K=async()=>{if(0!==I.value.length)try{u.value=!0,c.value=0;const e=new E,t=I.value.length;for(let l=0;l<I.value.length;l++){const a=I.value[l],r=await fetch(a.dataUrl),s=await r.blob(),o=a.name;e.file(o,s),c.value=Math.round((l+1)/t*100)}const a=await e.generateAsync({type:"blob"});A(a,"all_original_images.zip"),$(`成功导出 ${I.value.length} 张原图`,"success")}catch(e){$("导出失败，请重试","error")}finally{u.value=!1,c.value=0}},ee=e=>{O("删除图片","确定要删除这张图片吗？此操作无法撤销。","warning",()=>{o.removeImage(e),$("图片已删除","info")})},te=()=>{O("清空全部",`确定要清空所有 ${I.value.length} 张图片吗？此操作无法撤销。`,"danger",()=>{o.images=[],o.currentImage=null,o.clearHistory(),$("已清空所有图片","info")})},ae=e=>{if(e.ctrlKey||e.metaKey)switch(e.key.toLowerCase()){case"z":e.preventDefault(),F();break;case"y":e.preventDefault(),X();break;case"s":e.preventDefault(),z.value&&q();break;case"u":e.preventDefault(),document.querySelector(".upload-zone")?.click()}};return w(()=>{window.addEventListener("keydown",ae)}),C(()=>{window.removeEventListener("keydown",ae)}),(e,t)=>(l(),r("div",Zt,[s("div",ea,[s("div",ta,[t[1]||(t[1]=s("div",null,[s("h2",{class:"text-3xl font-bold text-gray-800 dark:text-white mb-2"}," 图片裁剪工具 "),s("p",{class:"text-gray-600 dark:text-gray-400"}," 上传图片，设置参数，一键裁剪并下载 ")],-1)),j(Kt)])]),s("div",aa,[s("div",la,[j(G,{onUpload:W}),z.value?(l(),r("div",ra,[s("div",sa,[s("h3",oa,[t[2]||(t[2]=s("svg",{class:"w-5 h-5 mr-2 text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),f(" "+d(z.value.name),1)]),s("div",na,[s("button",{onClick:F,disabled:!U.value,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"撤销 (Ctrl+Z)"},[...t[3]||(t[3]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"})],-1)])],8,ia),s("button",{onClick:X,disabled:!_.value,class:"p-2 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"重做 (Ctrl+Y)"},[...t[4]||(t[4]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 10h-10a8 8 0 00-8 8v2M21 10l-6 6m6-6l-6-6"})],-1)])],8,ua)])]),(l(),M(Z,{ref_key:"cropperRef",ref:i,image:z.value,key:z.value?.id},null,8,["image"])),s("div",da,[s("button",{onClick:q,class:"btn-primary flex items-center space-x-2"},[...t[5]||(t[5]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),s("span",null,"下载当前裁剪",-1)])]),s("button",{onClick:Q,class:"btn-primary flex items-center space-x-2"},[t[6]||(t[6]=s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)),s("span",null,"裁剪网格 ("+d(B.value)+"x"+d(P.value)+")",1)]),s("button",{onClick:J,disabled:u.value,class:"btn-secondary flex items-center space-x-2"},[t[7]||(t[7]=s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})],-1)),s("span",null,d(u.value?`处理中 ${c.value}%`:"批量裁剪所有图片"),1)],8,ca),I.value.length>1?(l(),r("button",{key:0,onClick:K,class:"btn-secondary flex items-center space-x-2"},[...t[8]||(t[8]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),s("span",null,"导出所有原图",-1)])])):h("",!0),s("button",{onClick:te,class:"px-4 py-2 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors flex items-center space-x-2"},[...t[9]||(t[9]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1),s("span",null,"清空全部",-1)])])])])):h("",!0),z.value?(l(),M(mt,{key:1,image:z.value,cropper:i.value?.cropper},null,8,["image","cropper"])):h("",!0)]),s("div",ma,[j(we),j(jt),z.value?(l(),M(Te,{key:0,cropper:i.value?.cropper},null,8,["cropper"])):h("",!0),I.value.length>0?(l(),r("div",ga,[s("h3",pa,[t[10]||(t[10]=s("svg",{class:"w-5 h-5 mr-2 text-primary-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})],-1)),f(" 图片列表 ("+d(I.value.length)+") ",1)]),j(Xe,{onRemove:ee})])):h("",!0)])]),s("div",va,[(l(!0),r(y,null,x(m.value,e=>(l(),M(Vt,{key:e.id,message:e.message,type:e.type,duration:e.duration,position:"bottom-left",onClose:t=>(e=>{const t=m.value.findIndex(t=>t.id===e);t>-1&&m.value.splice(t,1)})(e.id)},null,8,["message","type","duration","onClose"]))),128))]),j(Nt,{visible:p.value,"onUpdate:visible":t[0]||(t[0]=e=>p.value=e),title:v.value,message:b.value,type:k.value,onConfirm:D,onCancel:N},null,8,["visible","title","message","type"])]))}};export{ya as default};
